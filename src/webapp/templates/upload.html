{% extends "base.html" %}
{% block title %}Upload & Predict{% endblock %}

{% block content %}

<div class="row justify-content-center mt-4">
    <div class="col-md-6">

        <div class="card shadow-sm">
            <div class="card-body p-4">

                <h4 class="fw-bold mb-3 text-center">
                    Upload CSV File for Prediction
                </h4>

                {% with messages = get_flashed_messages(with_categories=true) %}
                  {% for category, message in messages %}
                    <div class="alert alert-{{ category }}">{{ message }}</div>
                  {% endfor %}
                {% endwith %}

                <!-- âœ… CORRECT FORM -->
                <form method="POST"
                    action="{{ url_for('upload_predict') }}"
                    enctype="multipart/form-data"
                    onsubmit="showSpinner()">

                    <div class="mb-3">
                        <input type="file" name="file" class="form-control" required>
                    </div>

                    <button type="submit" id="predictBtn" class="btn btn-primary">
                        Upload & Predict
                    </button>

                    <!-- Spinner -->
                    <div id="loadingSpinner" class="mt-3 d-none">
                        <div class="spinner-border text-primary" role="status"></div>
                        <span class="ms-2">Processing prediction...</span>
                    </div>
                </form>

            </div>
        </div>

    </div>
</div>

<script>
function showSpinner() {
    document.getElementById("predictBtn").disabled = true;
    document.getElementById("loadingSpinner").classList.remove("d-none");
}
</script>

{% endblock %}
